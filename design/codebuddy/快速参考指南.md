# CodeBuddy 快速参考指南

## 设计核心概念

### 1. 三大学习模式

#### 场景学习模式
```
目标: 在真实场景中自然练习英语

特点:
- 场景化模拟（咖啡厅、酒店、机场等）
- AI角色扮演（服务员、前台、同事等）
- 环境音效营造沉浸感
- 学习点自动关联场景

用户流程:
选择场景 → 了解背景 → 角色扮演对话 → 收集学习点 → 复习
```

#### 社交学习模式
```
目标: 在真实社交中应用所学

特点:
- 在线匹配语伴
- AI实时辅助（纠错+替身）
- 卡壳救场机制
- 社交学习统计

用户流程:
匹配语伴 → 开始对话 → AI辅助 → 学习点收集 → 持续进步
```

#### 电影学习模式
```
目标: 从经典中学习地道表达

特点:
- 电影片段角色扮演
- 跟读分析+对比
- 情感标注和指导
- 学习点场景关联

用户流程:
选择电影 → 选择场景 → 跟读练习 → 角色扮演 → 掌握台词
```

---

### 2. AI教练系统

#### AI人格设计
```
Name: Emma
性格: 友好、耐心、鼓励性强
口音: 美式默认，可切换
语气: 温和支持，偶尔幽默

语言风格:
✓ "我们一起学习" (not "you need to learn")
✓ "放松点，错了没事" (not "that's wrong")
✓ "很好的尝试" (not just correcting)
✓ "试试这个更好的表达" (not "say it like this")
```

#### 纠错策略
```
触发条件:
- 语法错误
- 发音问题
- 流利度低
- 不地道表达

纠错方式:
1. 先确认: "很好！" / "很好的尝试"
2. 温和建议: "试试这样说"
3. 原因说明: 简洁易懂
4. 示范+对比: 听觉+视觉对比
5. 选择权: [接受] [跳过] [学习]

语气: 温和支持，不打断对话流
```

#### 学习状态感知
```
检测维度:
- 回应速度 (快→紧张, 慢→犹豫)
- 语音特征 (结巴→紧张, 流利→自信)
- 请求频率 (频繁→困难, 正常→正常)

AI策略:
紧张状态:
- 更多鼓励
- 更慢节奏
- 更多简单词汇
- 更多停顿时间

自信状态:
- 更多挑战
- 更复杂话题
- 更快节奏
- 引导深入表达
```

---

### 3. 智能复习系统

#### 学习点结构
```
LearningPoint {
  id: string
  type: 'vocabulary' | 'grammar' | 'pronunciation' | 'expression'
  word: string
  source_scene: string  // 来源场景
  source_sentence: string
  emotion_tag: string  // 情感标注
  mastery_level: number  // 0-100
  review_count: number
  last_review_at: timestamp
  next_review_at: timestamp
}
```

#### 复习计划生成算法
```
Input: 今日学习点列表

Process:
1. 按掌握度排序 (低的优先)
2. 按类型分组 (词汇、语法、发音、表达)
3. 根据艾宾浩斯曲线计算下次复习时间
4. 选择前10-20个点
5. 生成复习时间表

Output:
{
  review_date: timestamp,
  review_points: LearningPoint[],
  estimated_improvement: number,  // %提升
  total_time: number  // 所需时间
}
```

#### 嵌入式复习
```
触发时机: 用户开始新对话时

嵌入方式:
1. 检测对话主题和场景
2. 查找相关的复习点
3. 选择1-2个最相关的
4. AI教练在对话中自然引导使用

示例:
AI: "今天我们在咖啡厅练习。还记得上次学过'cappuccino'吗？"
AI: "你想点的时候可以试试用这个词。"
User: "I'd like a cappuccino."
AI: "太好了！这正是我们之前复习过的。"
```

---

### 4. 口音系统

#### 支持的口音
```
┌─────────────────────────────────────┐
│ 口音类型    地区        TTS引擎    │
├─────────────────────────────────────┤
│ 美式通用    USA       Azure/Google │
│ 美式南方    USA (South)  Azure     │
│ 英式RP       UK         Google    │
│ 英式伦敦     UK (London) Azure     │
│ 澳式通用    Australia   Amazon    │
│ 印度式       India       Azure     │
│ 新加坡式     Singapore   Google    │
│ 加拿大式     Canada      Azure     │
│ 更多...      ...        ...       │
└─────────────────────────────────────┘
```

#### 语音对比分析
```
分析维度:
- 语调 (Pitch variation) - 0-100分
- 停顿 (Pause naturalness) - 0-100分
- 重音 (Stress accuracy) - 0-100分
- 清晰度 (Clarity) - 0-100分
- 情感 (Emotion match) - 0-100分

可视化:
┌─────────────────────────────────────┐
│ 波形对比图                       │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│ 标准口音: ════════════════    │
│ 你的发音: ════════════════    │
│                                  │
│ 总体评分: 85/100               │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
└─────────────────────────────────────┘

具体建议:
- 语调: 良好，可以更丰富
- 停顿: 优秀，很自然
- 重音: 需要加强"get"的发音
- 清晰度: 很好，继续保持
- 情感: 还可以，试试更自信
```

---

### 5. 社交英语助手

#### 匹配系统
```
匹配因素:
- 主题选择 (日常/职场/旅行等)
- 等级筛选 (初级/中级/高级)
- 语言偏好 (英式/美式等)
- 在线状态 (在线/离开)

匹配流程:
1. 用户设置匹配条件
2. 系统匹配相似语伴
3. 显示匹配列表
4. 用户选择发起
5. 对方接受后建立连接
```

#### AI辅助模式
```
功能: 实时语音/文本优化

触发: 用户在对话中说话/打字

处理流程:
1. 实时分析输入
2. 检测错误点
3. 生成优化建议
4. 用户选择: [接受] [跳过] [学习]
5. 发送优化版本或保持原话

卡壳处理:
1. 检测沉默 > 5秒
2. 分析上下文和主题
3. 生成2-3个替身话术
4. 显示给用户选择
5. 可AI代说或用户模仿
```

#### 隐私保护
```
可见性:
- 不显示真实姓名
- 不显示位置信息
- 可设置匿名匹配

记录:
- 用户可选择记录/不记录对话
- AI辅助记录可导出
- 学习点记录可删除
```

---

### 6. 电影台词学习

#### 电影选择
```
推荐来源:
- 公开版权电影片段
- 用户上传内容
- 合作电影库授权

分类:
- 剧情 (The Shawshank Redemption, Forrest Gump)
- 喜剧 (Friends, The Office)
- 动画 (Pixar, Disney)
- 科幻 (Interstellar, The Matrix)
```

#### 跟读分析
```
分析输出:
1. 波形对比图
2. 多维度评分
3. 具体改进建议
4. 进步趋势

进步追踪:
- 今日最佳分数
- 历史趋势图
- 达标率统计
- 薄弱点识别
```

#### 角色扮演
```
角色信息:
- 姓名
- 性格特征
- 说话风格
- 情感基调
- 关键台词

扮演流程:
1. 用户选择角色
2. AI扮演对手戏角色
3. 显示角色信息和情感提示
4. 用户说台词，AI自然回应
5. 维持角色一致性
```

---

## UI组件规范

### 色彩系统
```
主色 (Primary): #F59E0B (橙色系) - 活力、友好
辅助色 (Secondary): #3B82F6 (蓝色系) - 专业、信任
成功色 (Success): #10B981 (绿色系) - 鼓励、进步
警告色 (Warning): #F59E0B (琥珀色) - 温和提示
错误色 (Error): #EF4444 (红色系) - 仅严重错误
背景色 (Background): #F9FAFB (米白色) - 护眼、长时舒适
文字色 (Text): #1F2937 (深灰色) - 高对比度、易读
次级文字 (Text Secondary): #64748B (中灰色) - 层次清晰
```

### 圆角系统
```
大圆角: 16px - 卡片、弹窗
中圆角: 12px - 容器
小圆角: 8px - 按钮、标签
微圆角: 4px - 输入框、徽章
```

### 间距系统
```
页面边距: 24px
卡片间距: 16px
元素间距: 8px
组件内边距: 12px
紧凑间距: 4px
```

### 字体系统
```
标题1: 24px, Semibold (页面标题)
标题2: 20px, Semibold (卡片标题)
正文: 16px, Regular (主要内容)
辅助: 14px, Regular (次要信息)
小字: 12px, Regular (提示文字)
```

### 图标风格
```
设计: 线性图标
线宽: 2px
填充: 部分实心，部分描边
风格: 友好、现代、统一
来源: 自定义或使用开源库(Heroicons)
```

---

## 关键用户流程

### 新用户首次使用
```
1. 欢迎界面 → 介绍Emma、说明学习方式
2. 设置目标 → 选择场景、设置学习时长
3. 选择口音 → 试听不同口音，选择偏好
4. 开始学习 → 进入第一个场景
5. 首次对话 → Emma引导，温和介绍功能
6. 学习点收集 → 自动收集，展示进步
7. 复习计划生成 → 展示明日复习
8. 结束欢迎 → 鼓励持续学习
```

### 每日学习流程
```
1. 打开App → 查看今日场景和学习进度
2. 开始学习 → 进入场景学习或继续昨日
3. 沉浸学习 → 对话练习，收集学习点
4. 复习巩固 → 查看复习计划，完成复习
5. 进步查看 → 查看学习统计和趋势
6. 设置明日 → 调整学习计划和目标
```

### 场景完成流程
```
1. 进度100% → 庆祝动画显示
2. 学习报告 → 展示本次学习成果
3. 学习点汇总 → 收集的所有学习点
4. 复习计划 → AI生成明日复习
5. 奖励发放 → 根据进度解锁奖励
6. 下一场景 → 引导继续学习
```

---

## 技术架构建议

### 前端技术栈
```
框架: Makepad + Rust
优势:
- 性能优秀
- 跨平台(桌面端优先)
- 语音处理能力强
- 原生体验好
```

### 后端服务
```
语音服务:
- ASR: OpenAI Whisper / Google Speech-to-Text
- TTS: Azure Speech / Google TTS (多口音支持)
- 语音分析: 自研 + 语音API结合

AI服务:
- 对话: OpenAI GPT-4 / Claude 3
- 纠错: OpenAI GPT-4 (专门prompt)
- 学习分析: Claude 3 (长文本分析)

数据存储:
- SQLite (本地)
- 云同步 (可选)
```

### 数据模型
```
核心表:
- users (用户)
- scenes (场景)
- learning_points (学习点)
- conversations (对话记录)
- review_plans (复习计划)
- social_matches (社交匹配)
- movie_clips (电影片段)
```

---

## 开发优先级

### Phase 1: MVP (4周)
- ✅ 场景化主界面
- ✅ AI基础对话教练
- ✅ 温和纠错系统
- ✅ 学习点自动收集
- ✅ 简单复习系统

### Phase 2: 扩展 (4周)
- ✅ 口音切换功能
- ✅ 学习状态感知
- ✅ 进步可视化
- ✅ 里程碑奖励系统
- ✅ 场景管理(增加场景)

### Phase 3: 社交 (4周)
- ✅ 社交英语助手
- ✅ 在线匹配系统
- ✅ AI卡壳替身
- ✅ 社交学习统计

### Phase 4: 电影 (4周)
- ✅ 电影台词学习
- ✅ 跟读分析系统
- ✅ 角色扮演功能
- ✅ 电影场景管理

### Phase 5: 优化 (4周)
- ✅ 深度AI分析
- ✅ 个性化学习路径
- ✅ 学习效果预测
- ✅ 用户社区功能

---

## 常用快捷键

```
全局:
Ctrl/Cmd + S: 设置
Ctrl/Cmd + H: 历史
Ctrl/Cmd + N: 新学习
Ctrl/Cmd + R: 复习
Ctrl/Cmd + Q: 退出

对话中:
Space: 暂停/继续
Ctrl/Cmd + Enter: 发送
Tab: 切换到下一个学习点
Esc: 关闭提示

语音模式:
Ctrl/Cmd + M: 静音/取消静音
Ctrl/Cmd + L: 语言切换
Ctrl/Cmd + P: 播放/暂停
Ctrl/Cmd + R: 重新录音

社交模式:
Ctrl/Cmd + A: 接受纠错
Ctrl/Cmd + S: 跳过纠错
Ctrl/Cmd + H: 卡壳替身
Ctrl/Cmd + E: 结束对话
```

---

## 参考资料

### 设计灵感来源
- Duolingo - 游戏化学习
- HelloTalk - 社交语言学习
- ELSA Speak - 语音分析
- Mondly - 场景化学习
- LingoDeer - 沉浸式学习

### 相关学术论文
- Spaced Repetition System (间隔重复)
- Language Anxiety Research (语言焦虑研究)
- Immersive Learning (沉浸式学习理论)
- Social Language Learning (社交语言学习)

### 工具和资源
- Figma/Sketch - 设计工具
- Rust - 开发语言
- Makepad - UI框架
- OpenAI/Anthropic API - AI服务
```

---

## 术语表

| 术语 | 解释 |
|------|------|
| AI教练 | 扮演AI角色的智能辅导系统，有个性、有温度 |
| 场景化 | 将语言学习置于真实场景中，增强代入感 |
| 学习点 | 用户在学习中收集的词汇、语法、发音等知识点 |
| 嵌入式复习 | 在新的学习对话中自然复习旧知识点 |
| 卡壳替身 | 用户说话卡住时，AI生成替身话术 |
| 情感标注 | 标注语言的情感基调(坚定/犹豫/兴奋等) |
| 口音对比 | 用户发音 vs 标准口音的实时波形对比 |
| 里程碑 | 学习过程中的重要成就节点 |
| 智能复习 | AI自动生成复习计划，基于遗忘曲线 |

---

*文档版本: v1.0*
*最后更新: 2025-01-12*
*维护者: CodeBuddy Design Team*
